#!/usr/bin/env bash

find . -type f -executable > .executables || exit 1
cat .executables | sed -r 's/\/\.?[^\.\/]+(\.sh)?$/& ###/' | sed -r '/ ###$/d' > .a1 || exit 1
max=(`wc -l .a1`)
if (( ! max )); then
	echo "Nothing to do. Exiting."
	exit
fi
echo "Found $max files. Sleeping 2 sec. and processing."
sleep 2

cat .a1 | while read i; do
	echo "$i"
	chmod a-x "$i" || exit 1
done

echo "ALL DONE. $max files processed successfully."
